<!doctype html>
<html class="default no-js">
<head>
	<meta charset="utf-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<title>gaba</title>
	<meta name="description" content="">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<link rel="stylesheet" href="assets/css/main.css">
</head>
<body>
<header>
	<div class="tsd-page-toolbar">
		<div class="container">
			<div class="table-wrap">
				<div class="table-cell" id="tsd-search" data-index="assets/js/search.js" data-base=".">
					<div class="field">
						<label for="tsd-search-field" class="tsd-widget search no-caption">Search</label>
						<input id="tsd-search-field" type="text" />
					</div>
					<ul class="results">
						<li class="state loading">Preparing search index...</li>
						<li class="state failure">The search index is not available</li>
					</ul>
					<a href="index.html" class="title">gaba</a>
				</div>
				<div class="table-cell" id="tsd-widgets">
					<div id="tsd-filter">
						<a href="#" class="tsd-widget options no-caption" data-toggle="options">Options</a>
						<div class="tsd-filter-group">
							<div class="tsd-select" id="tsd-filter-visibility">
								<span class="tsd-select-label">All</span>
								<ul class="tsd-select-list">
									<li data-value="public">Public</li>
									<li data-value="protected">Public/Protected</li>
									<li data-value="private" class="selected">All</li>
								</ul>
							</div>
							<input type="checkbox" id="tsd-filter-inherited" checked />
							<label class="tsd-widget" for="tsd-filter-inherited">Inherited</label>
							<input type="checkbox" id="tsd-filter-externals" checked />
							<label class="tsd-widget" for="tsd-filter-externals">Externals</label>
						</div>
					</div>
					<a href="#" class="tsd-widget menu no-caption" data-toggle="menu">Menu</a>
				</div>
			</div>
		</div>
	</div>
	<div class="tsd-page-title">
		<div class="container">
			<ul class="tsd-breadcrumb">
				<li>
					<a href="globals.html">Globals</a>
				</li>
			</ul>
			<h1> gaba</h1>
		</div>
	</div>
</header>
<div class="container container-main">
	<div class="row">
		<div class="col-8 col-content">
			<div class="tsd-panel tsd-typography">
				<p><img src="https://raw.githubusercontent.com/metamask/gaba/master/logo.png" alt="gaba logo"></p>
				<p>The <strong>GABA</strong> engine is a collection of platform-agnostic modules for creating secure data models for cryptocurrency wallets. Every module exposes a common store interface for configuration, state management, and subscription. Modules are single-purpose and can be composed together into a single store that can be used as a robust data model for wallet frontends regardless of their intended platform.</p>
				<p><a href="https://travis-ci.org/MetaMask/gaba"><img src="https://travis-ci.org/MetaMask/gaba.svg?branch=master" alt="Build Status"></a>
				<a href="https://codecov.io/gh/MetaMask/gaba"><img src="https://codecov.io/gh/MetaMask/gaba/branch/master/graph/badge.svg" alt="codecov"></a></p>
				<h2 id="table-of-contents">Table of Contents</h2>
				<ul>
					<li><a href="/#usage">Usage</a></li>
					<li><a href="/#modules">Modules</a></li>
					<li><a href="/#concepts">Concepts</a><ul>
							<li><a href="/#initialization">Initialization</a></li>
							<li><a href="/#configuration">Configuration</a></li>
							<li><a href="/#state-management">State management</a></li>
							<li><a href="/#subscription">Subscription</a></li>
							<li><a href="/#composition">Composition</a></li>
						</ul>
					</li>
					<li><a href="/#typescript">TypeScript</a></li>
					<li><a href="/#license">License</a></li>
				</ul>
				<h2 id="usage">Usage</h2>
				<ol>
					<li>Install the package:<pre><code> npm <span class="hljs-selector-tag">i</span> gaba
</code></pre></li>
					<li><p>Compose stores to create a data model:</p>
						<pre><code class="lang-js"> <span class="hljs-keyword">import</span> {
     ComposableController,
     NetworkStatusController,
     TokenRatesController
 } <span class="hljs-keyword">from</span> <span class="hljs-string">'gaba'</span>;

 <span class="hljs-keyword">const</span> datamodel = <span class="hljs-keyword">new</span> ComposableController({
     <span class="hljs-attr">networkStatus</span>: <span class="hljs-keyword">new</span> NetworkStatusController(),
     <span class="hljs-attr">tokenRates</span>: <span class="hljs-keyword">new</span> TokenRatesController()
 });

 datamodel.subscribe(<span class="hljs-function">(<span class="hljs-params">state</span>) =&gt;</span> { <span class="hljs-comment">/* data model has changed */</span> });
</code></pre>
					</li>
				</ol>
				<h2 id="modules">Modules</h2>
				<p>The GABA engine consists of a collection of modules that each expose uniform APIs for common operations like configuration, state management, and subscription.</p>
				<p><strong>AddressBookController</strong></p>
				<pre><code class="lang-ts"><span class="hljs-keyword">import</span> AddressBookController <span class="hljs-keyword">from</span> <span class="hljs-string">'gaba'</span>;
</code></pre>
				<p>The AddressBookController exposes functions for managing a list of recipient addresses and associated nicknames.</p>
				<p><strong>BlockHistoryController</strong></p>
				<pre><code class="lang-ts"><span class="hljs-keyword">import</span> BlockHistoryController <span class="hljs-keyword">from</span> <span class="hljs-string">'gaba'</span>;
</code></pre>
				<p>The BlockHistoryController maintains a set number of past blocks that are backfilled upon initialization.</p>
				<p><strong>CurrencyRateController</strong></p>
				<pre><code class="lang-ts"><span class="hljs-keyword">import</span> CurrencyRateController <span class="hljs-keyword">from</span> <span class="hljs-string">'gaba'</span>;
</code></pre>
				<p>The CurrencyRateController passively polls for an ETH-to-fiat exchange rate based on a chosen currency.</p>
				<p><strong>NetworkStatusController</strong></p>
				<pre><code class="lang-ts"><span class="hljs-keyword">import</span> NetworkStatusController <span class="hljs-keyword">from</span> <span class="hljs-string">'gaba'</span>;
</code></pre>
				<p>The NetworkStatusController passively polls for the status of available provider networks. The Infura network is supported by default.</p>
				<p><strong>PhishingController</strong></p>
				<pre><code class="lang-ts"><span class="hljs-keyword">import</span> PhishingController <span class="hljs-keyword">from</span> <span class="hljs-string">'gaba'</span>;
</code></pre>
				<p>The PhishingController passively polls for community-maintained lists of approved and unapproved website origins.</p>
				<p><strong>ShapeShiftController</strong></p>
				<pre><code class="lang-ts"><span class="hljs-keyword">import</span> ShapeShiftController <span class="hljs-keyword">from</span> <span class="hljs-string">'gaba'</span>;
</code></pre>
				<p>The ShapeShiftController exposes functions for creating ShapeShift purchases and tracks past transactions.</p>
				<p><strong>TokenRatesController</strong></p>
				<pre><code class="lang-ts"><span class="hljs-keyword">import</span> TokenRatesController <span class="hljs-keyword">from</span> <span class="hljs-string">'gaba'</span>;
</code></pre>
				<p>The TokenRatesController passively polls for token-to-ETH exchange rates based on a list of available tokens.</p>
				<h2 id="concepts">Concepts</h2>
				<p>Using GABA modules should be straightforward since each module exposes the same minimal API. The concepts detailed in this section form the entirety of the core API: knowing these concepts will allow you to fully use the GABA engine to build wallet data models.</p>
				<h3 id="initialization">Initialization</h3>
				<p>Each GABA module can be initialized with an optional initial state argument and an optional initial configuration argument:</p>
				<pre><code class="lang-ts"><span class="hljs-keyword">const</span> controller = <span class="hljs-keyword">new</span> Controller(&lt;initial_state&gt;, &lt;initial_config&gt;)
</code></pre>
				<p>Data passed into a module as initial state will be merged with that module&#39;s default state; likewise, options passed into a module as initial configuration will be merged with that module&#39;s default configuration.</p>
				<h3 id="configuration">Configuration</h3>
				<p>As mentioned in the <a href="/#initialization">initialization section</a>, a GABA module can be configured during initialization by passing in a configuration object as a second argument:</p>
				<pre><code class="lang-ts"><span class="hljs-keyword">const</span> controller = <span class="hljs-keyword">new</span> Controller(&lt;initial_state&gt;, &lt;initial_config&gt;)
</code></pre>
				<p>A GABA module can also be configured (or reconfigured) after initialization by passing a configuration object to its <code>configure</code> method:</p>
				<pre><code class="lang-ts"><span class="hljs-keyword">const</span> controller = <span class="hljs-keyword">new</span> Controller()
controller.configure({ foo: <span class="hljs-string">'bar'</span>, baz: <span class="hljs-string">'qux'</span> });
</code></pre>
				<p>Regardless of how a module is configured, whether it&#39;s during or after initialization, configuration options can always be accessed on a module as instance variables for convenience:</p>
				<pre><code class="lang-ts"><span class="hljs-keyword">const</span> controller = <span class="hljs-keyword">new</span> Controller()
controller.configure({ foo: <span class="hljs-string">'bar'</span>, baz: <span class="hljs-string">'qux'</span> });
<span class="hljs-built_in">console</span>.log(controller.foo, controller.baz); <span class="hljs-comment">// "bar qux"</span>
</code></pre>
				<p><strong>Advanced Note:</strong> Options passed into a module as for configuration will be set on that module as instance variables. For example, if a configuration object of <code>{ foo: &#39;bar&#39; }</code> is passed into a module, the <code>foo</code> property will internally be set on the module itself: <code>controller.foo = &#39;bar&#39;</code>.</p>
				<h3 id="state-management">State management</h3>
				<p>The core purpose of every GABA module is to maintain an internal data object called &quot;state&quot;. Modules are like data stores; their internal state data can be updated directly by modifying the data itself or indirectly by calling API methods that in turn modify the data.</p>
				<p>A GABA module&#39;s state can be directly modified by calling the <code>update</code> method and passing in a new data object. By default, this data object will be merged with the module&#39;s existing internal state; however, if the data object should overwrite the module&#39;s internal state, a second argument of <code>true</code> can be passed to the <code>update</code> method:</p>
				<pre><code class="lang-ts"><span class="hljs-keyword">const</span> controller = <span class="hljs-keyword">new</span> Controller();
controller.update({ foo: <span class="hljs-string">'bar'</span> }); <span class="hljs-comment">// merge with existing state</span>
controller.update({ foo: <span class="hljs-string">'bar'</span> }, <span class="hljs-literal">true</span>); <span class="hljs-comment">// overwrite existing state</span>
</code></pre>
				<p>A GABA module&#39;s state can be indirectly modified by calling various API methods exposed on each specific controller. For example, the AddressBookController exposes a <code>set</code> method that accepts a new address to store and an associated nickname; calling this method will internally update its <code>state.addressBook</code> array.</p>
				<p>A GABA module&#39;s state can be always accessed by referencing the <code>state</code> instance variable for convenience:</p>
				<pre><code class="lang-ts"><span class="hljs-keyword">const</span> controller = <span class="hljs-keyword">new</span> Controller();
<span class="hljs-built_in">console</span>.log(controller.state); <span class="hljs-comment">// { ... }</span>
</code></pre>
				<h3 id="subscription">Subscription</h3>
				<p>Since each GABA module maintains an internal state object, there should be a way to add listeners to be notified when state data changes. GABA modules expose two methods for subscription management, <code>subscribe</code> and <code>unsubscribe</code>.</p>
				<p>Change handlers can be registered with a GABA module by passing a function to its <code>subscribe</code> method. This function will be called anytime the module&#39;s underlying state changes and will be passed the current state as its only function argument:</p>
				<pre><code class="lang-ts"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">onChange</span>(<span class="hljs-params">state</span>) </span>{ <span class="hljs-comment">/* state data changed */</span> }
<span class="hljs-keyword">const</span> controller = <span class="hljs-keyword">new</span> Controller();
controller.subscribe(onChange);
</code></pre>
				<p>Change handlers can be removed from a GABA module by passing a function to its <code>unsubscribe</code> method. Any function passed to <code>unsubscribe</code> will be removed from the internal list of handlers and will no longer be called when state data changes:</p>
				<pre><code class="lang-ts"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">onChange</span>(<span class="hljs-params">state</span>) </span>{ <span class="hljs-comment">/* state data changed */</span> }
<span class="hljs-keyword">const</span> controller = <span class="hljs-keyword">new</span> Controller();
controller.subscribe(onChange);
<span class="hljs-comment">//</span>
controller.unsubscribe(onChange);
</code></pre>
				<h3 id="composition">Composition</h3>
				<p>Because each GABA module maintains its own state and subscriptions, it would be tedious to initialize and subscribe to every available module independently. To solve this issue, the ComposableController can be used to compose multiple GABA modules into a single controller.</p>
				<p>The ComposableController is initialized by passing an object mapping unique names to child GABA module instances:</p>
				<pre><code class="lang-ts">    <span class="hljs-keyword">import</span> {
        ComposableController,
        NetworkStatusController,
        TokenRatesController
    } <span class="hljs-keyword">from</span> <span class="hljs-string">'gaba'</span>;

    <span class="hljs-keyword">const</span> datamodel = <span class="hljs-keyword">new</span> ComposableController({
        networkStatus: <span class="hljs-keyword">new</span> NetworkStatusController(),
        tokenRates: <span class="hljs-keyword">new</span> TokenRatesController()
    });
</code></pre>
				<p>The resulting composed module exposes the same APIs as every other GABA module for configuration, state management, and subscription:</p>
				<pre><code class="lang-ts">datamodel.subscribe(<span class="hljs-function">(<span class="hljs-params">state</span>) =&gt;</span> { <span class="hljs-comment">/* some child state has changed */</span> });
</code></pre>
				<p>The internal state maintained by a ComposableController will be keyed by the same object keys used during initialization. It&#39;s also possible to access the <code>flatState</code> instance variable that is a convenience accessor for merged child state:</p>
				<pre><code class="lang-ts"><span class="hljs-built_in">console</span>.log(datamodel.state); <span class="hljs-comment">// {networkStatus: {...}, tokenRates: {...}}</span>
<span class="hljs-built_in">console</span>.log(datamodel.flatState); <span class="hljs-comment">// {infura: {...}, contractExchangeRates: [...]}</span>
</code></pre>
				<p><strong>Advanced Note:</strong> The object used to initialize a ComposableController is cached as a <code>context</code> instance variable on both the ComposableController itself as well as all child GABA modules. This means that child modules can call methods on other sibling modules through the <code>context</code> variable, e.g. <code>this.context.someController.someMethod()</code>.</p>
				<h2 id="typescript">TypeScript</h2>
				<p>The GABA engine is written using <a href="https://www.typescriptlang.org/">TypeScript</a>. Despite its arguably steeper learning curve compared to JavaScript, TypeScript offers an objectively safer development experience that directly improves the reliability and maintainability of a large codebase.</p>
				<p><strong>Eliminate unintentionally broken APIs</strong></p>
				<p>TypeScript eliminates the ability to introduce changes to a codebase that break the APIs between or within components. If the signature changes for a specific function in a given class, every use of that function will immediately fail to compile until updated to match the new signature. This same idea applies to every other construct of the language: if the type of a property on an object is changed from <code>string</code> to <code>boolean</code>, every invalid use of that property will immediately fail to compile, etc. This is one of the most powerful features of a statically typed language for a mission-critical, modular package like GABA: it&#39;s extremely difficult to unknowingly introduce side effects.</p>
				<p><strong>Share custom types and interfaces</strong></p>
				<p>The ability to describe the shape that code must adhere to allows for the safe consumption and sharing of code without the need for duck typing. An underwhelming but point-driving comparison could be that TypeScript provides an enforced and very advanced form of JSDoc. Common or complex object formats with type-checked members can be shared and guaranteed across a codebase. This eliminates logic paths that only serve to check for the existence or the type of certain properties on an object, which usually account for a large portion of the code paths in a JavaScript application. Codebases become pragmatic and composable.</p>
				<p><strong>Use transpiled language-forward features</strong></p>
				<p>TypeScript automatically transpiles the latest ECMAScript language features to any desired target gracefully down to ES3. Microsoft directly monitors, supports, and heavily steers the implementation progress of the latest ES2018 specification through its development of TypeScript and adds opt-in support for features as their API churn settles down even before official TC39 finalization. This means that even implementation-heavy features like <code>async</code> / <code>await</code> are down-emitted without the hassle of manually managing polyfills.</p>
				<p><strong>Other general OOP features</strong></p>
				<ul>
					<li><a href="https://www.typescriptlang.org/docs/handbook/generics.html">Generics</a></li>
					<li><a href="https://www.typescriptlang.org/docs/handbook/classes.html#public-private-and-protected-modifiers">Member visibility</a></li>
					<li><a href="https://www.typescriptlang.org/docs/handbook/enums.html">Enums</a></li>
					<li><a href="https://www.typescriptlang.org/docs/handbook/advanced-types.html">Advanced types</a> (e.g. union, intersection)</li>
					<li>Easy <a href="https://github.com/DefinitelyTyped/DefinitelyTyped">3rd-party typings management</a></li>
					<li><a href="https://www.typescriptlang.org/docs/handbook/mixins.html">Mixins </a></li>
					<li>Superset of JavaScript, so all JS is valid TS</li>
				</ul>
				<h2 id="license">License</h2>
				<p><a href="./LICENSE">MIT</a></p>
			</div>
		</div>
		<div class="col-4 col-menu menu-sticky-wrap menu-highlight">
			<nav class="tsd-navigation primary">
				<ul>
					<li class="globals  ">
						<a href="globals.html"><em>Globals</em></a>
					</li>
					<li class=" tsd-kind-external-module">
						<a href="modules/_addressbookcontroller_.html">"<wbr>Address<wbr>Book<wbr>Controller"</a>
					</li>
					<li class=" tsd-kind-external-module">
						<a href="modules/_basecontroller_.html">"<wbr>Base<wbr>Controller"</a>
					</li>
					<li class=" tsd-kind-external-module">
						<a href="modules/_blockhistorycontroller_.html">"<wbr>Block<wbr>History<wbr>Controller"</a>
					</li>
					<li class=" tsd-kind-external-module">
						<a href="modules/_composablecontroller_.html">"<wbr>Composable<wbr>Controller"</a>
					</li>
					<li class=" tsd-kind-external-module">
						<a href="modules/_currencyratecontroller_.html">"<wbr>Currency<wbr>Rate<wbr>Controller"</a>
					</li>
					<li class=" tsd-kind-external-module">
						<a href="modules/_networkstatuscontroller_.html">"<wbr>Network<wbr>Status<wbr>Controller"</a>
					</li>
					<li class=" tsd-kind-external-module">
						<a href="modules/_phishingcontroller_.html">"<wbr>Phishing<wbr>Controller"</a>
					</li>
					<li class=" tsd-kind-external-module">
						<a href="modules/_shapeshiftcontroller_.html">"<wbr>Shape<wbr>Shift<wbr>Controller"</a>
					</li>
					<li class=" tsd-kind-external-module">
						<a href="modules/_tokenratescontroller_.html">"<wbr>Token<wbr>Rates<wbr>Controller"</a>
					</li>
					<li class=" tsd-kind-external-module">
						<a href="modules/_index_.html">"index"</a>
					</li>
				</ul>
			</nav>
			<nav class="tsd-navigation secondary menu-sticky">
				<ul class="before-current">
				</ul>
			</nav>
		</div>
	</div>
</div>
<footer>
	<div class="container">
		<h2>Legend</h2>
		<div class="tsd-legend-group">
			<ul class="tsd-legend">
				<li class="tsd-kind-module"><span class="tsd-kind-icon">Module</span></li>
				<li class="tsd-kind-object-literal"><span class="tsd-kind-icon">Object literal</span></li>
				<li class="tsd-kind-variable"><span class="tsd-kind-icon">Variable</span></li>
				<li class="tsd-kind-function"><span class="tsd-kind-icon">Function</span></li>
				<li class="tsd-kind-function tsd-has-type-parameter"><span class="tsd-kind-icon">Function with type parameter</span></li>
				<li class="tsd-kind-index-signature"><span class="tsd-kind-icon">Index signature</span></li>
				<li class="tsd-kind-type-alias"><span class="tsd-kind-icon">Type alias</span></li>
			</ul>
			<ul class="tsd-legend">
				<li class="tsd-kind-enum"><span class="tsd-kind-icon">Enumeration</span></li>
				<li class="tsd-kind-enum-member"><span class="tsd-kind-icon">Enumeration member</span></li>
				<li class="tsd-kind-property tsd-parent-kind-enum"><span class="tsd-kind-icon">Property</span></li>
				<li class="tsd-kind-method tsd-parent-kind-enum"><span class="tsd-kind-icon">Method</span></li>
			</ul>
			<ul class="tsd-legend">
				<li class="tsd-kind-interface"><span class="tsd-kind-icon">Interface</span></li>
				<li class="tsd-kind-interface tsd-has-type-parameter"><span class="tsd-kind-icon">Interface with type parameter</span></li>
				<li class="tsd-kind-constructor tsd-parent-kind-interface"><span class="tsd-kind-icon">Constructor</span></li>
				<li class="tsd-kind-property tsd-parent-kind-interface"><span class="tsd-kind-icon">Property</span></li>
				<li class="tsd-kind-method tsd-parent-kind-interface"><span class="tsd-kind-icon">Method</span></li>
				<li class="tsd-kind-index-signature tsd-parent-kind-interface"><span class="tsd-kind-icon">Index signature</span></li>
			</ul>
			<ul class="tsd-legend">
				<li class="tsd-kind-class"><span class="tsd-kind-icon">Class</span></li>
				<li class="tsd-kind-class tsd-has-type-parameter"><span class="tsd-kind-icon">Class with type parameter</span></li>
				<li class="tsd-kind-constructor tsd-parent-kind-class"><span class="tsd-kind-icon">Constructor</span></li>
				<li class="tsd-kind-property tsd-parent-kind-class"><span class="tsd-kind-icon">Property</span></li>
				<li class="tsd-kind-method tsd-parent-kind-class"><span class="tsd-kind-icon">Method</span></li>
				<li class="tsd-kind-accessor tsd-parent-kind-class"><span class="tsd-kind-icon">Accessor</span></li>
				<li class="tsd-kind-index-signature tsd-parent-kind-class"><span class="tsd-kind-icon">Index signature</span></li>
			</ul>
			<ul class="tsd-legend">
				<li class="tsd-kind-constructor tsd-parent-kind-class tsd-is-inherited"><span class="tsd-kind-icon">Inherited constructor</span></li>
				<li class="tsd-kind-property tsd-parent-kind-class tsd-is-inherited"><span class="tsd-kind-icon">Inherited property</span></li>
				<li class="tsd-kind-method tsd-parent-kind-class tsd-is-inherited"><span class="tsd-kind-icon">Inherited method</span></li>
				<li class="tsd-kind-accessor tsd-parent-kind-class tsd-is-inherited"><span class="tsd-kind-icon">Inherited accessor</span></li>
			</ul>
			<ul class="tsd-legend">
				<li class="tsd-kind-property tsd-parent-kind-class tsd-is-protected"><span class="tsd-kind-icon">Protected property</span></li>
				<li class="tsd-kind-method tsd-parent-kind-class tsd-is-protected"><span class="tsd-kind-icon">Protected method</span></li>
				<li class="tsd-kind-accessor tsd-parent-kind-class tsd-is-protected"><span class="tsd-kind-icon">Protected accessor</span></li>
			</ul>
			<ul class="tsd-legend">
				<li class="tsd-kind-property tsd-parent-kind-class tsd-is-private"><span class="tsd-kind-icon">Private property</span></li>
				<li class="tsd-kind-method tsd-parent-kind-class tsd-is-private"><span class="tsd-kind-icon">Private method</span></li>
				<li class="tsd-kind-accessor tsd-parent-kind-class tsd-is-private"><span class="tsd-kind-icon">Private accessor</span></li>
			</ul>
			<ul class="tsd-legend">
				<li class="tsd-kind-property tsd-parent-kind-class tsd-is-static"><span class="tsd-kind-icon">Static property</span></li>
				<li class="tsd-kind-call-signature tsd-parent-kind-class tsd-is-static"><span class="tsd-kind-icon">Static method</span></li>
			</ul>
		</div>
	</div>
</footer>
<div class="overlay"></div>
<script src="assets/js/main.js"></script>
<script>if (location.protocol == 'file:') document.write('<script src="assets/js/search.js"><' + '/script>');</script>
</body>
</html>